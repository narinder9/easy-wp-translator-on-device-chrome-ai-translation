(()=>{"use strict";var t=jQuery(".post_lang_choice"),e=function(){t.attr("data-old-value",t.children(":selected").first().val())};function a(){jQuery(".tr_lang").each(function(){var t=jQuery(this).attr("id").substring(8),e=jQuery(this).parent().parent().siblings(".ewt-edit-column");jQuery(this).autocomplete({minLength:0,source:ajaxurl+"?action=ewt_posts_not_translated&post_language="+jQuery(".post_lang_choice").val()+"&translation_language="+t+"&post_type="+jQuery("#post_type").val()+"&_ewt_nonce="+jQuery("#_ewt_nonce").val(),select:function(a,n){jQuery("#htr_lang_"+t).val(n.item.id),e.html(n.item.link)}}),jQuery(this).on("blur",function(){jQuery(this).val()||(jQuery("#htr_lang_"+t).val(0),e.html(e.siblings(".hidden").children().clone()))})})}jQuery(function(t){t.ajaxPrefilter(function(e,a,n){var i=t(".post_lang_choice").val();"string"==typeof e.data&&-1!==e.url.indexOf("action=ajax-tag-search")&&i&&(e.data="lang="+i+"&"+e.data)})}),jQuery(function(t){tagBox.get=function(e){var a=e.substr(e.indexOf("-")+1),n={action:"get-tagcloud",lang:t(".post_lang_choice").val(),tax:a};t.post(ajaxurl,n,function(n,i){0!=n&&"success"==i||(n=wpAjax.broken),n=t("<div />").addClass("the-tagcloud").attr("id","tagcloud-"+a).html(n),t("a",n).on("click",function(){return tagBox.flushTags(t(this).closest(".inside").children(".tagsdiv"),this),!1});var l=t("#tagcloud-"+a).css("display");l?(t("#tagcloud-"+a).replaceWith(n),t("#tagcloud-"+a).css("display",l)):t("#"+e).after(n)})}}),jQuery(function(i){var l=new Array;i(".categorydiv").each(function(){var t,e;(t=i(this).attr("id").split("-")).shift(),e=t.join("-"),l.push(e),i("#"+e+"-add-submit").before(i("<input />").attr("type","hidden").attr("id",e+"-lang").attr("name","term_lang_choice").attr("value",i(".post_lang_choice").val()))}),e(),i(".post_lang_choice").on("change",function(e){var n,o,s,r=function(){var e=wp.i18n.__,a=jQuery("<div/>",{id:"ewt-dialog",style:"display:none;"}).text(e("Are you sure you want to change the language of the current content?","easy-wp-translator"));t.after(a);var n=new Promise(function(n,i){var l=function(e){switch(e){case"yes":t.data("old-value",t.children(":selected").first().val()),n();break;case"no":t.val(t.data("old-value")),i("Cancel")}a.dialog("close")},o={autoOpen:!1,modal:!0,draggable:!1,resizable:!1,title:e("Change language","easy-wp-translator"),minWidth:600,maxWidth:"100%",open:function(t,e){jQuery("body").hasClass("rtl")&&jQuery(this).parent().css({right:jQuery(this).parent().css("left"),left:"auto"})},close:function(t,e){l("no")},buttons:[{text:e("OK","easy-wp-translator"),click:function(t){l("yes")}},{text:e("Cancel","easy-wp-translator"),click:function(t){l("no")}}]};Object.assign(o,{classes:{"ui-dialog":"ewt-confirmation-modal"}}),a.dialog(o)});return{dialogContainer:a,dialogResult:n}}(),c=r.dialogContainer,d=r.dialogResult,u=e.target;i(this).data("old-value")!==u.value&&(n=i("input#title").val(),o=i("textarea#content").val(),s=i("textarea#excerpt").val(),n||o||s)?c.dialog("open"):d=Promise.resolve(),d.then(function(){var t={action:"ewt_post_lang_choice",lang:u.value,post_type:i("#post_type").val(),taxonomies:l,post_id:i("#post_ID").val(),_ewt_nonce:i("#_ewt_nonce").val()};i.post(ajaxurl,t,function(t){var e=wpAjax.parseAjaxResponse(t,"ewt-ajax-response");i.each(e.responses,function(){switch(this.what){case"translations":i(".translations").html(this.data),a();break;case"taxonomy":var t=this.data;i("#"+t+"checklist").html(this.supplemental.all),i("#"+t+"checklist-pop").html(this.supplemental.populars),i("#new"+t+"_parent").replaceWith(this.supplemental.dropdown),i("#"+t+"-lang").val(i(".post_lang_choice").val());break;case"pages":i("#parent_id").html(this.data);break;case"flag":i(".ewt-select-flag").html(this.data);break;case"permalink":var e=i("#edit-slug-box");"-1"!=this.data&&e.children().length&&e.html(this.data)}});var n=new CustomEvent("onPostLangChoice",{detail:{lang:JSON.parse(u.options[u.options.selectedIndex].getAttribute("data-lang"))}});document.dispatchEvent(n)})},function(){})}),document.addEventListener("onPostLangChoice",function(t){e(),i(".tagcloud-link").each(function(){var t=i(this).attr("id");tagBox.get(t)});var a=t.detail.lang.is_rtl?"rtl":"ltr";i("body").removeClass("ewt-dir-rtl").removeClass("ewt-dir-ltr").addClass("ewt-dir-"+a),i("#content_ifr").contents().find("html").attr("lang",t.detail.lang.locale).attr("dir",a),i("#content_ifr").contents().find("body").attr("dir",a),n.media.resetAllAttachmentsCollections()}),a()});var n=window.ewt||{};_.extend(n,{media:{}});var i=_.extend(n.media,{attachmentsCollections:[],query:function(t){var e=n.media.query.delegate(t);return n.media.attachmentsCollections.push(e),e},resetAllAttachmentsCollections:function(){this.attachmentsCollections.forEach(function(t){t.reset(),t.mirroring&&(t.mirroring._hasMore=!0,t.mirroring.reset())})}});"undefined"!=typeof wp&&void 0!==wp.media&&(i.query=_.extend(i.query,{delegate:wp.media.query}),wp.media.query=i.query)})();