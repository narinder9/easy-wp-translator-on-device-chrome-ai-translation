/*! For license information please see post.min.js.LICENSE.txt */
(()=>{"use strict";const e=window.wp.plugins,t=window.wp.i18n,n=window.wp.editPost,r=window.wp.components,a=window.wp.apiFetch,l=window.wp.element,i=window.wp.data,o=window.React,c=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},u=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),s=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const f=(0,o.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:i,...c},f)=>(0,o.createElement)("svg",{ref:f,...d,width:t,height:t,stroke:e,strokeWidth:r?24*Number(n)/Number(t):n,className:u("lucide",a),...!l&&!s(c)&&{"aria-hidden":"true"},...c},[...i.map(([e,t])=>(0,o.createElement)(e,t)),...Array.isArray(l)?l:[l]])),p=(e,t)=>{const n=(0,o.forwardRef)(({className:n,...r},a)=>{return(0,o.createElement)(f,{ref:a,iconNode:t,className:u(`lucide-${l=c(e),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...r});var l});return n.displayName=c(e),n},m=p("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),y=p("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function g(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,u=Object.create(c.prototype);return v(u,"_invoke",function(n,r,a){var l,o,c,u=0,s=a||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return l=t,o=0,c=e,f.n=n,i}};function p(n,r){for(o=n,c=r,t=0;!d&&u&&!a&&t<s.length;t++){var a,l=s[t],p=f.p,m=l[2];n>3?(a=m===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=p&&((a=n<2&&p<l[1])?(o=0,f.v=r,f.n=l[1]):p<m&&(a=n<3||l[0]>r||r>m)&&(l[4]=n,l[5]=r,f.n=m,o=0))}if(a||n>1)return i;throw d=!0,r}return function(a,s,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===s&&p(s,m),o=s,c=m;(t=o<2?e:c)||!d;){l||(o?o<3?(o>1&&(f.n=-1),p(o,c)):f.n=c:f.v=c);try{if(u=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(t){l=e,o=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,a,l),!0),u}var i={};function o(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(v(t={},r,function(){return this}),t),d=u.prototype=o.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,v(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,v(d,"constructor",u),v(u,"constructor",c),c.displayName="GeneratorFunction",v(u,a,"GeneratorFunction"),v(d),v(d,a,"Generator"),v(d,r,function(){return this}),v(d,"toString",function(){return"[object Generator]"}),(g=function(){return{w:l,m:f}})()}function v(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}v=function(e,t,n,r){function l(t,n){v(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},v(e,t,n,r)}function h(e,t,n,r,a,l,i){try{var o=e[l](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(r,a)}function w(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var l=e.apply(t,n);function i(e){h(l,r,a,i,o,"next",e)}function o(e){h(l,r,a,i,o,"throw",e)}i(void 0)})}}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,i,o=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(o.push(r.value),o.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var k,E,R="ewt-post-sidebar",S=function(){try{if("undefined"!=typeof ewt_block_editor_plugin_settings)return ewt_block_editor_plugin_settings}catch(e){}return"undefined"!=typeof window&&window.ewt_block_editor_plugin_settings?window.ewt_block_editor_plugin_settings:{lang:null,translations_table:{}}},C=function(e){var n=e.lang,a=e.allLanguages,i=(0,l.useMemo)(function(){var e=[];return n&&e.push({label:n.name,value:n.slug,flag_url:n.flag_url}),Object.values(a).forEach(function(t){e.push({label:t.lang.name,value:t.lang.slug,flag_url:t.lang.flag_url})}),e},[n,a]);return React.createElement(r.PanelBody,{title:(0,t.__)("Language","easy-wp-translator"),initialOpen:!0},React.createElement(r.Flex,{align:"center"},React.createElement(r.FlexItem,null,null!=n&&n.flag_url?React.createElement("img",{src:n.flag_url,alt:(null==n?void 0:n.name)||"",className:"flag",style:{marginRight:8,width:20,height:14}}):null),React.createElement(r.FlexItem,{style:{flex:1}},React.createElement(r.SelectControl,{label:void 0,value:(null==n?void 0:n.slug)||"",onChange:function(e){if(e&&(!n||e!==n.slug)){var t=null==a?void 0:a[e];if(t&&t.links){var r=t.links.edit_link||t.links.add_link;r&&(window.location.href=r)}}},help:void 0,options:i.map(function(e){return{label:e.label,value:e.value}})}))))},A=function(e){var n=e.row,o=n.lang,c=n.translated_post,u=n.links,s=(null==c?void 0:c.title)||"",d=b((0,l.useState)(s),2),f=d[0],p=d[1],v=b((0,l.useState)(!1),2),h=v[0],_=v[1],k=b((0,l.useState)(""),2),E=k[0],R=k[1],S=b((0,l.useState)([]),2),C=S[0],A=S[1],T=b((0,l.useState)(!1),2),P=T[0],x=T[1],I=b((0,l.useState)([]),2),O=I[0],j=I[1],L=b((0,l.useState)(null),2),F=L[0],N=L[1],W=b((0,l.useState)(!1),2),G=W[0],M=W[1],q=!s,D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=(0,l.useRef)(null),r=(0,l.useRef)(e);r.current=e;var a=(0,l.useCallback)(function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];n.current&&clearTimeout(n.current),n.current=setTimeout(function(){r.current.apply(r,a)},t)},[t]);return[a,(0,l.useCallback)(function(){n.current&&(clearTimeout(n.current),n.current=null)},[])]}(function(){var e=w(g().m(function e(n){var r;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=(n||"").trim()){e.n=1;break}return e.a(2);case 1:return e.p=1,_(!0),R(""),e.n=2,a({path:"/ewt/v1/translation-title",method:"POST",data:{postId:(null==c?void 0:c.id)||null,lang:null==o?void 0:o.slug,title:r}});case 2:_(!1),e.n=4;break;case 3:e.p=3,e.v,_(!1),R((0,t.__)("Failed to save title. Please try again.","easy-wp-translator"));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),2e3),z=(b(D,1)[0],!(null==u||!u.edit_link)),B=!(null==u||!u.add_link),$=(0,l.useCallback)(w(g().m(function e(){var t;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!(P||C.length>0)){e.n=1;break}return e.a(2);case 1:return e.p=1,x(!0),e.n=2,a({path:"/ewt/v1/languages/utils/get_all_pages_data"});case 2:t=e.v,A(Array.isArray(t)?t:[]),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,x(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])})),[P,C.length]),U=(0,l.useCallback)(function(e){var t=(e||"").trim().toLowerCase();return t?C.filter(function(e){var n,r=(null==e||null===(n=e.language)||void 0===n?void 0:n.slug)===(null==o?void 0:o.slug),a=!(null!=e&&e.is_linked),l=((null==e?void 0:e.title)||"").toLowerCase().includes(t)||((null==e?void 0:e.slug)||"").toLowerCase().includes(t);return r&&a&&l}).slice(0,10):[]},[C,null==o?void 0:o.slug]),Z=function(){var e=w(g().m(function e(n){var r,l,c;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.preventDefault(),F){e.n=1;break}return e.a(2);case 1:return e.p=1,M(!0),R(""),c=null===(r=(0,i.select)("core/editor"))||void 0===r||null===(l=r.getCurrentPostId)||void 0===l?void 0:l.call(r),e.n=2,a({path:"/ewt/v1/languages/link-translation",method:"POST",data:{source_id:c,target_id:F.ID,target_lang:null==o?void 0:o.slug}});case 2:window.location.reload(),e.n=4;break;case 3:e.p=3,e.v,R((0,t.__)("Failed to link page. Please try again.","easy-wp-translator"));case 4:return e.p=4,M(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=w(g().m(function e(n){var r,l,c,s,d,p,m;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.preventDefault(),r=(f||"").trim()){e.n=1;break}return null!=u&&u.add_link&&(window.location.href=u.add_link),e.a(2);case 1:return e.p=1,M(!0),R(""),p=null===(l=(0,i.select)("core/editor"))||void 0===l||null===(c=l.getCurrentPostId)||void 0===c?void 0:c.call(l),m=null===(s=(0,i.select)("core/editor"))||void 0===s||null===(d=s.getCurrentPostType)||void 0===d?void 0:d.call(s),e.n=2,a({path:"/ewt/v1/languages/create-translation",method:"POST",data:{source_id:p,target_lang:null==o?void 0:o.slug,title:r,post_type:m||"page"}});case 2:window.location.reload(),e.n=4;break;case 3:e.p=3,e.v,R((0,t.__)("Failed to create page. Please try again.","easy-wp-translator"));case 4:return e.p=4,M(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}();return React.createElement("div",{style:{marginBottom:12}},React.createElement(r.Flex,{align:"center",style:{marginBottom:8,alignItems:"start"}},React.createElement(r.FlexItem,{style:{paddingTop:"14px"}},null!=o&&o.flag_url?React.createElement("img",{src:o.flag_url,alt:(null==o?void 0:o.name)||"",style:{width:20,height:14}}):null),React.createElement(r.FlexItem,{style:{flex:1,padding:"0px"}},React.createElement(r.TextControl,{value:f,onChange:function(e){p(e),N(null),q&&(e&&e.trim().length>1?0===C.length?$().then(function(){j(U(e))}):j(U(e)):j([]))},placeholder:(0,t.__)("title","easy-wp-translator"),readOnly:!q,disabled:!q,help:q?h?(0,t.__)("Saving…","easy-wp-translator"):(0,t.__)("Type title to save translation.","easy-wp-translator"):(0,t.__)("Modify title via Edit.","easy-wp-translator")})),React.createElement(r.FlexItem,{style:{paddingTop:"14px"}},z?React.createElement("a",{href:u.edit_link,"aria-label":(0,t.__)("Edit translation","easy-wp-translator"),style:{marginLeft:8,height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement(m,{size:20})):null,!z&&(F?React.createElement("button",{onClick:Z,"aria-label":(0,t.__)("Link existing page","easy-wp-translator"),style:{marginLeft:8,background:"transparent",border:0,padding:0,cursor:"pointer"}},React.createElement(y,{size:20})):B?(f||"").trim().length>0?React.createElement("button",{onClick:H,"aria-label":(0,t.__)("Create translation from typed title","easy-wp-translator"),style:{marginLeft:8,background:"transparent",border:0,padding:0,cursor:"pointer"}},React.createElement(y,{size:20})):React.createElement("a",{href:u.add_link,"aria-label":(0,t.__)("Add translation","easy-wp-translator"),style:{marginLeft:8,height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement(y,{size:20})):null),h||G?React.createElement(r.Spinner,{style:{marginLeft:8}}):null)),q&&O.length>0?React.createElement("div",{style:{marginTop:4}},O.map(function(e){return React.createElement("div",{key:e.ID,style:{padding:"4px 6px",cursor:"pointer",background:(null==F?void 0:F.ID)===e.ID?"#eef":"transparent"},onClick:function(){return N(e)},onMouseEnter:function(){return N(e)}},e.title," (",e.slug,")")})):null,E?React.createElement(r.Notice,{status:"error",isDismissible:!1},E):null)},T=function(e){var n=e.translations,a=Object.values(n);return React.createElement(r.PanelBody,{title:(0,t.__)("Translations","easy-wp-translator"),initialOpen:!0},a.map(function(e){return React.createElement(A,{key:e.lang.slug,row:e})}))},P=null!=(E=(null==(k=S())?void 0:k.lang)||null)&&E.flag_url?React.createElement("img",{src:E.flag_url,alt:(null==E?void 0:E.name)||"",style:{width:16,height:11}}):React.createElement("svg",{width:"16",height:"11",viewBox:"0 0 16 11"},React.createElement("rect",{width:"16",height:"11",fill:"#ddd"}));(0,e.registerPlugin)(R,{render:function(){var e=S(),r=(null==e?void 0:e.lang)||null,a=(null==e?void 0:e.translations_table)||{};return React.createElement(React.Fragment,null,React.createElement(n.PluginSidebarMoreMenuItem,{target:R},(0,t.__)("EasyWPTranslator","easy-wp-translator")),React.createElement(n.PluginSidebar,{name:R,title:(0,t.__)("EasyWPTranslator","easy-wp-translator")},React.createElement(C,{lang:r,allLanguages:a}),React.createElement(T,{translations:a})))},icon:P});var x=wp.data.subscribe,I=new URLSearchParams(window.location.search);if(I.has("lang")||I.has("new_lang")){var O=null,j=0,L=!1,F=function(){if(j++,L)return!0;try{var e=wp.data.select("core/edit-post"),t=wp.data.dispatch("core/edit-post");if(!e||!t)return!1;var n=wp.data.select("core/interface"),r=wp.data.dispatch("core/interface"),a="plugin-sidebar/".concat(R),l=!1;if("function"==typeof t.openGeneralSidebar)try{"function"==typeof t.closeGeneralSidebar&&t.closeGeneralSidebar(),"function"==typeof t.setIsInserterOpened&&t.setIsInserterOpened(!1),t.openGeneralSidebar(a),l=!0}catch(e){}if(!l&&r&&"function"==typeof r.enableComplementaryArea)try{"function"==typeof r.enableComplementaryArea&&r.enableComplementaryArea("core/edit-post",a),"function"==typeof r.pinItem&&r.pinItem("core/edit-post",a),l=!0}catch(e){}if(r)try{"function"==typeof r.setDefaultComplementaryArea&&r.setDefaultComplementaryArea("core/edit-post",a),"function"==typeof r.setActiveComplementaryArea&&r.setActiveComplementaryArea("core/edit-post",a)}catch(e){}if(!l&&"function"==typeof t.enableComplementaryArea)try{t.enableComplementaryArea("core/edit-post",a),l=!0}catch(e){}if(l)return setTimeout(function(){var t=null;if(e.getActiveComplementaryArea&&(t=e.getActiveComplementaryArea("core/edit-post")),!t&&n&&n.getActiveComplementaryArea&&(t=n.getActiveComplementaryArea("core/edit-post")),t===a)setTimeout(function(){var e=document.querySelector(".interface-complementary-area, .edit-post-sidebar, .components-panel"),t=document.querySelector(".interface-interface-skeleton__sidebar, .edit-post-layout__sidebar");e&&(null!==e.offsetParent&&!e.hidden||(e.style.display="block",e.style.visibility="visible",e.style.opacity="1",e.hidden=!1,t&&(t.style.display="block",t.style.visibility="visible",t.style.width="280px"))),setTimeout(function(){var e=document.querySelector('button[aria-label*="Settings"], .edit-post-header__settings button, button[data-label*="Settings"]'),t=!document.querySelector(".interface-complementary-area:not([hidden])");e&&t&&(e.click(),setTimeout(function(){var e=document.querySelector('button[aria-label*="EasyWPTranslator"], .components-button[aria-label*="EasyWPTranslator"]');e&&e.click()},300))},200)},100),L=!0,O&&(O(),O=null);else{var r=document.querySelector('[data-sidebar="'.concat(R,'"], .').concat(R));r&&null!==r.offsetParent&&(L=!0,O&&(O(),O=null))}},500),L;setTimeout(function(){var e=document.querySelector('button[aria-label*="EasyWPTranslator"], button[data-label*="EasyWPTranslator"], [data-sidebar="'.concat(R,'"]'));e&&(e.click(),setTimeout(function(){var e=document.querySelector(".interface-complementary-area");e&&null!==e.offsetParent&&(L=!0,O&&(O(),O=null))},300))},500)}catch(e){}return j>=50&&O&&(O(),O=null),!1};setTimeout(function(){if(!F()){O=x(function(){!L&&j<50&&F()});var e=setInterval(function(){L||j>=50?clearInterval(e):F()},1e3);setTimeout(function(){e&&clearInterval(e),O&&(O(),O=null)},3e4)}},500)}})();